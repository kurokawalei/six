const api_pach="kurokawa",config={headers:{Authorization:"sNSFHkuxupYBy2nL1EZHexiDb652"}};let orderAry=[];const list=document.querySelector(".renderlist"),delAllBtn=document.querySelector(".discardAllBtn");function getOrderList(){axios.get("https://hexschoollivejs.herokuapp.com/api/livejs/v1/admin/kurokawa/orders",config).then((function(t){orderAry=t.data.orders,renOrdList(),loadC3()})).catch((function(t){}))}function renOrdList(){let t="";orderAry.forEach(((e,r)=>{const a=new Date(1e3*e.createdAt),n=`${a.getFullYear()}/${a.getMonth()+1}/${a.getDate()}`;let d="";e.products.forEach(((t,e)=>{d+=`<div>${t.title} x ${t.quantity}</div>`}));let i="";i=1==e.paid?"已處理":"未處理",t+=`<tr>\n       <td>${e.id}</td>\n       <td>\n         <p>${e.user.name}</p>\n         <p>${e.user.tel}</p>\n       </td>\n       <td>${e.user.address}</td>\n       <td>${e.user.email}</td>\n       <td>\n         ${d}\n       </td>\n       <td>${n}</td>\n       <td >\n         <a href="javascript:;" data-id="${e.id}" data-states="${e.paid}" class="orderStatus">${i}</a>\n       </td>\n       <td>\n         <input type="button" class="delSingleOrder-Btn" value="刪除" data-id="${e.id}">\n       </td>\n   </tr>`})),list.innerHTML=t}function orderStates(t,e){let r;r=1!=e;let a={data:{id:t,paid:r}};axios.put("https://hexschoollivejs.herokuapp.com/api/livejs/v1/admin/kurokawa/orders",a,config).then((function(t){alert("訂單已處理"),getOrderList()}))}function delOrderList(t){axios.delete(`https://hexschoollivejs.herokuapp.com/api/livejs/v1/admin/kurokawa/orders/${t}`,config).then((function(t){alert("刪除單筆成功"),getOrderList()}))}function delAll(t){t.preventDefault(),axios.delete("https://hexschoollivejs.herokuapp.com/api/livejs/v1/admin/kurokawa/orders",config).then((function(t){alert("已全部刪除"),getOrderList()}))}function loadC3(){let t={};orderAry.forEach((function(e){e.products.forEach((function(e){null==t[e.category]?t[e.category]=e.price*e.quantity:t[e.category]+=e.price*e.quantity}))}));let e=Object.keys(t),r=[];e.forEach(((e,a)=>{let n=[];n.push(e),n.push(t[e]),r.push(n)}));c3.generate({bindto:"#chart",data:{type:"pie",columns:r}})}getOrderList(),list.addEventListener("click",(function(t){let e=t.target.getAttribute("class"),r=t.target.getAttribute("data-id");if("delSingleOrder-Btn"!=e)if("orderStatus"!=e);else{orderStates(r,t.target.getAttribute("data-states"))}else delOrderList(r)})),delAllBtn.addEventListener("click",delAll);